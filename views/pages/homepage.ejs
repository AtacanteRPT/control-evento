<main>
    <div class="row">
        <div class="col s12">
            <div style="padding: 35px;" align="center" class="card">
                <div class="row">
                    <div class="left card-title">
                        <b>Controlar Asistencia</b>
                    </div>
                </div>

                <!--<div class="row">
                    <a href="#!">
                        <div style="padding: 30px;" class="grey lighten-3 col s5 waves-effect">
                            <i class="indigo-text text-lighten-1 large material-icons">person</i>
                            <span class="indigo-text text-lighten-1"><h5>Seller</h5></span>
                        </div>
                    </a>
                    <div class="col s1">&nbsp;</div>
                    <div class="col s1">&nbsp;</div>

                    <a href="#!">
                        <div style="padding: 30px;" class="grey lighten-3 col s5 waves-effect">
                            <i class="indigo-text text-lighten-1 large material-icons">people</i>
                            <span class="indigo-text text-lighten-1"><h5>Customer</h5></span>
                        </div>
                    </a>
                </div>-->

                <table class="striped" id="tablaMilitantes">
                    <thead>
                        <tr>
                            <th>Nro</th>
                            <th>Nombre</th>
                            <th>Cargo</th>
                            <th>Cedula</th>
                            <th>Asistencia</th>
                        </tr>
                    </thead>

                    <tbody>
                        <!--<tr>
                            <td>0</td>
                            <td>ToPa</td>
                            <td>Ricardo</td>
                            <td>707052</td>
                            <td>

                                <div class="switch">
                                    <label>
                                    NO
                                    <input type="checkbox">
                                    <span class="lever"></span>
                                    SI
                                  </label>
                                </div>
                            </td>
                        </tr>-->

                    </tbody>
                </table>



            </div>
        </div>


    </div>


    <div class="fixed-action-btn click-to-toggle" style="bottom: 45px; right: 24px;">
        <a class="btn-floating btn-large pink waves-effect waves-light">
            <i class="large material-icons">add</i>
        </a>

        <ul>
            <li>
                <a class="btn-floating red"><i class="material-icons">note_add</i></a>
                <a href="" class="btn-floating fab-tip">Add a note</a>
            </li>

            <li>
                <a class="btn-floating yellow darken-1"><i class="material-icons">add_a_photo</i></a>
                <a href="" class="btn-floating fab-tip">Add a photo</a>
            </li>

            <li>
                <a class="btn-floating green"><i class="material-icons">alarm_add</i></a>
                <a href="" class="btn-floating fab-tip">Add an alarm</a>
            </li>

            <li>
                <a class="btn-floating blue"><i class="material-icons">vpn_key</i></a>
                <a href="" class="btn-floating fab-tip">Add a master password</a>
            </li>
        </ul>
    </div>
</main>

<script>
    $('.button-collapse').sideNav();

    $('.collapsible').collapsible();

    $('select').material_select();


    var auxMilitantes = <%- JSON.stringify(militantes) %>

    // var votosTrue = auxMilitantes.filter(auxVoto => auxVoto.voto == true);
    // var auxAsistencias = votosTrue.length;

    auxMilitantes.forEach(function(militante, index) {
        $('#tablaMilitantes > tbody').append('<tr id="tr' + (index + 1) + '">' +
            '<td>' + (index + 1) + '</td>' +
            '<td>' + militante.paterno + ' ' + militante.materno + ' ' + militante.nombre + '</td>' +
            '<td>' + militante.cargo + '</td>' +
            '<td>' + militante.cedula + '</td>' +
            '<td>' + '<div class="switch"><label>NO<input id="voto' + militante.id + '" type="checkbox"><span class="lever"></span>SI</label></div>' + '</td>' +
            '</tr>')
        $('#voto' + militante.id).attr('checked', militante.asistencia)
        $('#voto' + militante.id).click(function() {
            console.log($('#voto' + militante.id).prop('checked'))
                // $.post("/militante/actualizarVoto", {
                //         id: militante.id,
                //         voto: $('#voto' + (index + 1)).prop('checked'),
                //     },
                //     function(data, status) {
                //         if ($('#voto' + (index + 1)).prop('checked')) {
                //             auxAsistencias++;
                //             $('#datoVoto1').text('Asistencia: ' + auxAsistencias);
                //         } else {
                //             auxAsistencias--;
                //             $('#datoVoto1').text('Asistencia: ' + auxAsistencias);
                //         }
                //         $('#datoVoto2').text('Faltas: ' + (auxMilitantes.length - auxAsistencias));
                //         // alert("Mensaje" + data);
                //         controlConteo()
                //     });
                // console.log($('#voto' + (index + 1)).attr('checked', false))
                // $('#tablaMilitantes > tbody > #tr' + (index + 1)).remove()
        })
    }, this);
    $('#inputVoto').keyup(function(event) {
        controlConteo()
    })
    $('#inputVoto2').keyup(function(event) {
        controlConteo()
    })
    $('#inputVoto3').keyup(function(event) {
        controlConteo()
    })
</script>